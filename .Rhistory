select(11:13, 28:29)
#Create a column with month and year
#merge_slp<-merge_alt%>%
# mutate(period=as.yearmon(paste(year, month), "%Y %m"))
#merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
#Create a column with month and year
#merge_slp<-merge_alt%>%
# mutate(period=as.yearmon(paste(year, month), "%Y %m"))
#merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
#scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
#Create a column with month and year
#merge_slp<-merge_alt%>%
# mutate(period=as.yearmon(paste(year, month), "%Y %m"))
#merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
scale_x_discrete(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0))+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
#Create a column with month and year
#merge_slp<-merge_alt%>%
# mutate(period=as.yearmon(paste(year, month), "%Y %m"))
#merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
scale_x_discrete(expand = c(0,0)) +
#scale_y_continuous(expand = c(0,0))+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
#Create a column with month and year
#merge_slp<-merge_alt%>%
# mutate(period=as.yearmon(paste(year, month), "%Y %m"))
#merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
#scale_x_discrete(expand = c(0,0)) +
#scale_y_continuous(expand = c(0,0))+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60)
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot7<-merge_hrt_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
plot7
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
plot8
plot9<-merge_hrt_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.2)
plot9
View(merge_hrt_longer)
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#CC79A7", "#009E73", "#0072B2"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#CC79A7", "#228B22", "#0072B2"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#CC79A7", "#9ACD32", "#0072B2"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#CC79A7", "#9ACD32", "#FF4500"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#FF4500", "#9ACD32", "#4169E1"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
#Pivot dataframe
merge_hrt_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
merge_hrt_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
#Line chart
plot8<-merge_hrt_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)+
scale_color_manual(
name="heart rate",
values = c("#FF4500", "#006400", "#4169E1"),
labels=c("Minimum bpm", "Average bpm", "Maximum bpm"))+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Heart rate by Month",
y="beats per minute",
x="month")
plot8
