efficiency>100 & efficiency<=200 ~ efficiency/2,
TRUE ~ efficiency/3
))
slp2<- slp%>%
as.integer(efficiency)%>%
mutate(
mean_eff=case_when(
efficiency<100 ~ efficiency,
efficiency>100 & efficiency<=200 ~ efficiency/2,
TRUE ~ efficiency/3
))
colSums(is.na(slp))
slp<-slp%>%
select(-type, -efficiency)
slp<-aggregate(. ~date, data = slp, sum, na.rm=TRUE, na.action=na.pass)
View(slp)
path <- "./Dataset/"
files <- dir(path, pattern = "*.json")
slp <- files %>%
map_df(~fromJSON(file.path(path, .), flatten = TRUE))
slp$dateOfSleep<-ymd(slp$dateOfSleep)
slp<-slp%>%
select(-1, -3:-6, -13:-16,-17, -19, -20, -22, -23,
-25, -26, -28, -29, -31, -33)%>%
rename(date=dateOfSleep)%>%
as_tibble()
min(slp$minutesAsleep)
slp<-slp%>%
select(-type, -efficiency)
slp<-aggregate(. ~date, data = slp, sum, na.rm=TRUE, na.action=na.pass)
alt<-con_date(alt)
dis<-con_date(dis)
hrt<-con_date(hrt)
lam<-con_date(lam)
mam<-con_date(mam)
sam<-con_date(sam)
slp<-con_date(slp)
slp_sc<-con_date(slp_sc)
vam<-con_date(vam)
View(hrt)
View(slp_sc)
#Merge the files. left join to hrt dataset
merge<-hrt%>%
left_join(alt, by="date")
View(merge)
library(plyr)
#Merge the files. left join to hrt dataset
merge<-join_all(list(hrt,alt,dis,lam,mam,sam,
vam,slp,slp_sc), by="date", type = "left")
View(merge)
sum(is.na(merge$min_bpm))
merge1<-hrt%>%
left_join(alt, by="date")
merge1<-merge1%>%
left_join(dis, by="date")
View(merge1)
merge1<-merge1%>%
left_join(lam, by="date")
merge1<-merge1%>%
left_join(mam, by="date")
merge1<-merge1%>%
left_join(sam, by="date")
merge1<-merge1%>%
left_join(vam, by="date")
merge1<-merge1%>%
left_join(hrt, by="date")
merge1<-merge1%>%
left_join(slp, by="date")
merge1<-merge1%>%
left_join(slp_sc, by="date")
merge1<-hrt%>%
left_join(alt, by="date")
merge1<-merge1%>%
left_join(dis, by="date")
merge1<-merge1%>%
left_join(lam, by="date")
merge1<-merge1%>%
left_join(mam, by="date")
merge1<-merge1%>%
left_join(sam, by="date")
merge1<-merge1%>%
left_join(vam, by="date")
merge1<-merge1%>%
left_join(slp, by="date")
merge1<-merge1%>%
left_join(slp_sc, by="date")
sum(duplicated(merge$date))
sum(duplicated(slp_sc$date))
View(slp_sc)
dup<-duplicated(slp_sc$date)
slp_sc$date[dup]
slp_sc<-read_csv("Dataset/sleep_score.csv")
View(slp_sc)
slp_sc<-slp_sc%>%
separate(timestamp,
into=c("date", "time"),
sep=" ")%>%
select(-time, -sleep_log_entry_id)
slp_sc$date<-ymd(slp_sc$date)
View(slp)
slp_sc<-read_csv("Dataset/sleep_score.csv")
slp_sc<-slp_sc%>%
separate(timestamp,
into=c("date", "time"),
sep=" ")%>%
select(-time, -sleep_log_entry_id, deep_sleep_in_minutes)
slp_sc$date<-ymd(slp_sc$date)
View(slp)
View(slp_sc)
View(slp_sc)
slp_sc<-read_csv("Dataset/sleep_score.csv")
slp_sc<-slp_sc%>%
separate(timestamp,
into=c("date", "time"),
sep=" ")%>%
select(-time, -sleep_log_entry_id, -deep_sleep_in_minutes)
slp_sc$date<-ymd(slp_sc$date)
View(slp_sc)
slp_sc2<-slp_sc%>%
group_by(date)%>%
summarise(across(everything(), mean))
#Mutate columns for sleep score
slp_sc2<-slp_sc%>%
group_by(date)%>%
summarize(across(everything(), mean))
detach("package:dplyr", unload = TRUE)
library(dplyr)
#Mutate columns for sleep score
slp_sc2<-slp_sc%>%
group_by(date)%>%
summarize(across(everything(), mean))
sum(duplicated(slp_sc$date))
sum(duplicated(slp_sc2$date))
#Aggregate sleep score by date
slp_sc<-slp_sc%>%
group_by(date)%>%
summarize(across(everything(), mean))
sum(duplicated(slp_sc$date))
alt<-con_date(alt)
dis<-con_date(dis)
hrt<-con_date(hrt)
lam<-con_date(lam)
mam<-con_date(mam)
sam<-con_date(sam)
slp<-con_date(slp)
slp_sc<-con_date(slp_sc)
vam<-con_date(vam)
#Merge the files. left join to hrt dataset
merge<-join_all(list(hrt,alt,dis,lam,mam,sam,
vam,slp,slp_sc), by="date", type = "left")
sum(is.na(merge))
View(merge)
library(tidyverse)
library(ggplot2)
library(plotly)
library(lubridate)
library(jsonlite)
View(merge)
##Convert distance units from centimeters to meters
merge$distance<-merge$distance/100
##Pivot longer by bpm
merge_longer<-merge%>%
pivot_longer(cols = c(min_bpm, max_bpm, avg_bpm),
names_to="bpm",
values_to="value")
fig1<-merge_longer%>%
ggplot(aes(x=date, y=bpm, color=bpm))+
geom_line()
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=bpm, color=bpm))+
geom_point()
fig1
View(merge_longer)
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_point()
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_area(mapping = aes(y = ifelse(y>95 & x< 162 , y, 0)),
color = "brown")
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_area(mapping = aes(y = ifelse(y>95 & y< 162 , y, 0)),
color = "brown")
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_area(mapping = aes(y = ifelse(value>95 & value< 162 , value, 0)),
color = "brown")
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_density()
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), fill = "red", lty = 2, alpha = 0.7)
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax,
xmin = xmin, xmax = xmax),
data = zone_data,
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE)
fig1
zone_data <- tibble(ymin = 95, ymax = 162, xmin = -Inf, xmax = Inf)
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax,
xmin = xmin, xmax = xmax),
data = zone_data,
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE)
fig1
fig1<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax,
xmin = xmin, xmax = xmax),
data = zone_data,
alpha = 0.2,
fill = "blue",
inherit.aes = FALSE)
fig1
install.packages("remotes")
install.packages("remotes")
install.packages("remotes")
remotes::install_github("hrbrmstr/streamgraph")
library(tidyverse)
library(ggplot2)
library(plotly)
library(lubridate)
library(jsonlite)
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
library(streamgraph)
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
merge_longer<-merge%>%
pivot_longer(cols = c(min_bpm, avg_bpm, max_bpm),
names_to="bpm",
values_to="value")
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
merge_longer<-merge%>%
pivot_longer(cols = c(avg_bpm, min_bpm, max_bpm),
names_to="bpm",
values_to="value")
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
merge_longer$bpm<-factor(merge_longer$bpm, levels = c("min_bpm", "avg_bpm", "max_bpm"))
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")
fig1
fig1 <- streamgraph(merge_longer, key="bpm", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="heartrates: ")%>%
sg_fill_brewer("Pastel1")
fig1
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig2
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_area(fill=bpm)
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(aes(ymin = 95, ymax = 162, xmin = -Inf, xmax = Inf),
fill = "pink", alpha = 0.03)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(aes(as.Date(ymin = 95), as.Date(ymax = 162), xmin = -Inf, xmax = Inf),
fill = "pink", alpha = 0.03)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_rect(aes(ymin = 95, ymax = 162,
as.Date(xmin = -Inf), as.Date(xmax = Inf)),
fill = "pink", alpha = 0.03)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value))+
geom_line()+
geom_rect(aes(ymin = 95, ymax = 162,
xmin = -Inf,xmax = Inf),
fill = "pink", alpha = 0.03)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value))+
geom_line()+
geom_ribbon(aes(x=time, ymax=162, ymin=95), fill="pink", alpha=.5)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.5)
fig
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.5)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.5)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.3)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.3)+
xlim("2020-09-28", "2021-03-27")
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.3)+
xlim(2020-09-28, 2021-03-27)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.3)
fig3
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.2)
fig3
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymin=162,ymax=y), fill="red",alpha=.2 )+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig3<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymax=162, ymin=95), fill="pink", alpha=.2)
fig3
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymin=162,ymax=200), fill="red",alpha=.2 )+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymin=162,ymax=value), fill="red",alpha=.2 )+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_ribbon(aes(ymin=162,ymax=190), fill="red",alpha=.2 )+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green")+
geom_ribbon(aes(ymin=162, ymax=200), fill="red", color="red") +
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green")+
geom_ribbon(aes(ymin=162, ymax=200), fill="red", color="red", alpha=.3) +
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.2)+
geom_ribbon(aes(ymin=162, ymax=200), fill="red", color="red", alpha=.2) +
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_ribbon(aes(ymin=162, ymax=200), fill="red",  alpha=.15) +
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_ribbon(aes(ymin=162, ymax=200), fill="red",  alpha=.15) +
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = 162) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
fig2<-merge_longer%>%
ggplot(aes(x=date, y=value, color=bpm))+
geom_line()+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7)
fig2
fig3<-merge_longer%>%
ggplot( aes(x = date, y = value, color=bpm)) +
geom_line() +
geom_ribbon(aes(ymin=95,ymax=162), fill="green", color="green", alpha=.15)+
geom_hline(yintercept = c(95, 162), col = "red", lty = 2, alpha = 0.7) + # move this under geom_ribbon for a nicer result
theme_minimal()
fig3
