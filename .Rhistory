plot3<-merge_alt%>%
drop_na(altitude)%>%
ggplot(aes(x=as.factor(month), y=altitude, fill=month))+
geom_boxplot(na.rm = TRUE)+
theme_minimal()+
scale_x_discrete(name ="Month",
limits=c("Sep","Oct","Nov",
"Dec","Jan","Feb"))+
labs(x = "Month",
y = "Altitude (m)",
title = "Monthly Altitude",
fill="Distance (m)")+
scale_fill_brewer(palette="Set2")+
theme(plot.title = element_text(hjust = 0.5, size = 14, face="bold",
margin = margin(t = 0, r = 0, b = 10, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 10,
b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 0, r = 0,
b = 10, l = 0)),
legend.position="none")
plot3
plot3
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
plot3<-merge_alt%>%
drop_na(altitude)%>%
ggplot(aes(x=as.factor(month), y=altitude, fill=month))+
geom_boxplot(na.rm = TRUE)+
theme_minimal()+
scale_x_discrete(name ="Month",
limits=c("Sep","Oct","Nov",
"Dec","Jan","Feb"))+
labs(x = "Month",
y = "Altitude (m)",
title = "Monthly Altitude",
fill="Distance (m)")+
scale_fill_brewer(palette="Set2")+
theme(plot.title = element_text(hjust = 0.5, size = 14, face="bold",
margin = margin(t = 0, r = 0, b = 10, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 10,
b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 0, r = 0,
b = 10, l = 0)),
legend.position="none")
plot3
merge_alt<-drop_na(merge_alt$altitude)
merge_alt$altitude<-drop_na(merge_alt$altitude)
sum(is.na(merge_alt$altitude))
merge_alt<-complete.cases(merge_alt$altitude)
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
plot3<-merge_alt%>%
drop_na(altitude)%>%
ggplot(aes(x=as.factor(month), y=altitude, fill=month))+
geom_boxplot(na.rm = TRUE)+
theme_minimal()+
scale_x_discrete(name ="Month",
limits=c("Sep","Oct","Nov",
"Dec","Jan","Feb"))+
labs(x = "Month",
y = "Altitude (m)",
title = "Monthly Altitude",
fill="Distance (m)")+
scale_fill_brewer(palette="Set2")+
theme(plot.title = element_text(hjust = 0.5, size = 14, face="bold",
margin = margin(t = 0, r = 0, b = 10, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 10,
b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 0, r = 0,
b = 10, l = 0)),
legend.position="none")
plot3
View(merge_alt)
merge_alt<-merge_alt%>%
drop_na(altitude)
shapiro.test(merge_alt$altitude)
AP.fit <- lm(merge_alt$altitude ~ time(merge_alt$month))
summary(AP.fit)
AP.fit <- lm(merge_alt$altitude ~ merge_alt$month)
summary(AP.fit)
AP.fit <- lm(merge_alt$altitude ~ time(merge_alt$month))
summary(AP.fit)
AP.ci <- predict(AP.fit, interval="confidence")
AP.ci
AP.fit <- lm(merge_alt$altitude ~ merge_alt$month)
summary(AP.fit)
View(merge_alt)
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)
View(merge_alt)
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="300px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="600px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="600px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="600px", width="800px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="600px", width="700px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="500px", width="750px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="expand", interpolate="linear", height="500px", width="750px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="500px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="600px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", interpolate="linear", height="590px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
#create month and day columns
merge_alt<-merge%>%
mutate(day=day(date),
month=month(date, label = TRUE),
year=year(date))
#Create a column with month and year
merge_alt<-merge_alt%>%
mutate(period=as.yearmon(paste(year, month), "%Y %m"))
merge_alt$period<-as.Date(merge_alt$period)#To allow mapping easier
merge_alt<-merge_alt%>%
drop_na(light_act_mins)%>%
drop_na(very_act_mins)%>%
drop_na(sedentary_mins)%>%
drop_na(moderate_act_mins)
#merge_dis_longer<-merge_dis%>%
#pivot_longer(cols = c(day, month),
#names_to="period",
#values_to="value")
merge_alt_longer<-merge_alt%>%
pivot_longer(cols = c(7:10),
names_to="activity",
values_to="value")
merge_alt_longer$activity<-factor(merge_alt_longer$activity,
levels = c("sedentary_mins", "light_act_mins",
"moderate_act_mins", "very_act_mins"))
plot4 <- streamgraph(merge_alt_longer, key="activity", value="value", date="date",
offset="zero", height="590px", width="1000px")%>%
sg_legend(show=TRUE, label="Activity: ")%>%
sg_fill_brewer("Pastel1")
plot4
