library(streamgraph)
library(jsonlite)
library(emo)
library(zoo)
library(viridis)
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type, group=type))+
geom_bar(stat = "identity", position = "fill")
f1
f1
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type))+
geom_bar(stat = "identity", position = "fill")
f1
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type))+
geom_bar(stat = "identity", position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_text(aes(label = lbl), size = 3,
position = position_stack(vjust = 0.5))+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type, group=type))+
geom_bar(stat = "identity", position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_text(aes(label = lbl), size = 3,
position = position_stack(vjust = 0.5))+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type, group=type))+
geom_bar(stat = "identity", position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-plotdata%>%
ggplot(aes(x=day, y=pct, fill=type, group=type))+
geom_bar(position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-plotdata%>%
ggplot(aes(x=day, fill=type))+
geom_bar(position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-plotdata%>%
ggplot(aes(x=day, fill=factor(type)))+
geom_bar(position = "fill")+
theme_minimal()+
theme(plot.title = element_text(color="black", size=14,
face="bold", hjust = 0.5),
axis.ticks = element_blank(),
legend.title = element_blank(),
axis.title.x = element_text(color="black", size=12, face="bold"),
axis.title.y = element_text(color="black", size=12))+
scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
geom_col(alpha = 0.8, width = 0.85) +
labs(title = "Fishing Rate by Fishing Region",
x="",
y="Percent")
f1
f1<-ggplot(plotdata,aes(x = day, y = pct, fill = type)) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
geom_text(aes(label = lbl),
size = 3,
position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Drive Train",
x = "Class",
title = "Automobile Drive by Class") +
theme_minimal()
f1
f1<-ggplot(plotdata,aes(x = day, y = pct, fill = type)) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Drive Train",
x = "Class",
title = "Automobile Drive by Class") +
theme_minimal()
f1
f1<-ggplot(plotdata,aes(x = month, y = pct, fill = type)) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Drive Train",
x = "Class",
title = "Automobile Drive by Class") +
theme_minimal()
f1
f1<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.asleep.minutes",
"levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes",
"levels.summary.wake.minutes"),
labels = c("asleep", "awake", "deep", "light",
"rem", "restless", "wake")))) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Drive Train",
x = "Class",
title = "Automobile Drive by Class") +
theme_minimal()
f1
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
View(plotdata)
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(pct=NaN, 0, pct))%>%
mutate(lbl=ifelse(lbl=NA, 0, lbl))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(pct==NaN, 0, pct))%>%
mutate(lbl=ifelse(lbl==NA, 0, lbl))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(pct=is.nan, 0, pct))%>%
mutate(lbl=ifelse(lbl=is.na, 0, lbl))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(pct==is.nan, 0, pct))%>%
mutate(lbl=ifelse(lbl==is.na, 0, lbl))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(is.nan(pct), 0, pct))%>%
mutate(lbl=ifelse(is.na(lbl), 0, lbl))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plotdata <- merge_slp_quality_l%>%
group_by(day, month, type)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))%>%
mutate(pct=ifelse(is.nan(pct), 0, pct))%>%
mutate(lbl=ifelse(is.na(lbl), 0, lbl))
plotdata$pct<-ifelse(is.nan(pct), 0, pct)
plotdata$pct<-ifelse(is.nan(plotdata$pct), 0, pct)
plotdata$pct<-ifelse(is.nan(plotdata$pct), 0, plotdata$pct)
plotdata$lbl=ifelse(is.na(plotdata$lbl), 0, plotdata$lbl)
plotdata1 <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct),
type_slp=type)
View(plotdata1)
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
View(plotdata)
f1<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.asleep.minutes",
"levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes",
"levels.summary.wake.minutes"),
labels = c("asleep", "awake", "deep", "light",
"rem", "restless", "wake")))) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Drive Train",
x = "Class",
title = "Automobile Drive by Class") +
theme_minimal()
f1
View(merge)
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20)
View(merge_slp_quality)
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#create month and day columns
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
#Pivot table
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#Availability vs Fishing rate
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plot7<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes"),
labels = c("awake", "deep", "light",
"rem", "restless")))) +
geom_bar(stat = "identity",
position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent) +
scale_fill_brewer(palette = "Set2") +
labs(y = "Percent",
fill = "Sleep Stage",
x = "Day",
title = "Sleep Stage by Day") +
theme_minimal()
plot7
#create month and day columns
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
#Pivot table
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#Availability vs Fishing rate
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plot7<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes"),
labels = c("awake", "deep", "light",
"rem", "restless")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2), label = percent) +
scale_fill_brewer(palette = "dark2") +
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(y = "Percent",
fill = "Sleep Stage",
x = "Day",
title = "Sleep Stage by Day")
plot7
#create month and day columns
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
#Pivot table
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#Availability vs Fishing rate
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plot7<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes"),
labels = c("awake", "deep", "light",
"rem", "restless")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2), label = percent) +
scale_fill_brewer(palette = "dark") +
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(y = "Percent",
fill = "Sleep Stage",
x = "Day",
title = "Sleep Stage by Day")
plot7
#create month and day columns
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
#Pivot table
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#Availability vs Fishing rate
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plot7<-ggplot(plotdata,aes(x = month, y = pct,
fill = factor(type,
levels = c("levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes"),
labels = c("awake", "deep", "light",
"rem", "restless")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2), label = percent) +
scale_fill_brewer(palette = "Set2") +
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(y = "Percent",
fill = "Sleep Stage",
x = "Day",
title = "Sleep Stage by Day")
plot7
#create month and day columns
merge_slp_quality<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(15, 17:20, 28:29)
#Pivot table
merge_slp_quality_l<-merge_slp_quality%>%
drop_na(levels.summary.deep.minutes)%>%
pivot_longer(cols = c(2:6),
names_to="type",
values_to="value")
#Availability vs Fishing rate
plotdata <- merge_slp_quality_l%>%
group_by(day, month)%>%
mutate(pct = value/sum(value),
lbl = scales::percent(pct))
plot7<-ggplot(plotdata,aes(x = day, y = pct,
fill = factor(type,
levels = c("levels.summary.awake.minutes",
"levels.summary.deep.minutes",
"levels.summary.light.minutes",
"levels.summary.rem.minutes",
"levels.summary.restless.minutes"),
labels = c("awake", "deep", "light",
"rem", "restless")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(breaks = seq(0, 1, .2), label = percent) +
scale_fill_brewer(palette = "Set2") +
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 12),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(y = "Percent",
fill = "Sleep Stage",
x = "Day",
title = "Sleep Stage by Day")
plot7
#create month and day columns
merge_slp<-merge%>%
mutate(day=wday(date, label=TRUE),
month=month(date, label = TRUE),
year=year(date))%>%
select(11:13, 28:29)
merge_slp<-merge_slp%>%
drop_na(minutesAsleep)
merge_slp_longer<-merge_slp%>%
pivot_longer(cols = c(2:4),
names_to="in_bed",
values_to="value")
plot5 <- merge_slp_longer%>%
ggplot(aes(x = day, y = value, fill=in_bed))+
geom_bar( stat = "identity")+
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0))+
scale_fill_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#999999"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 14),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Time in Bed by Days",
y="Minutes",
x="Day")
plot5
#Average sleeping time per day
merge_slp_avg<-merge_slp_longer%>%
group_by(day, in_bed)%>%
summarise(avg=mean(value, na.rm=TRUE))%>%
mutate(avg=avg/60) #convert minutes to hours
plot6<-merge_slp_avg%>%
ggplot(aes(x=day, y=avg, color=in_bed, group=in_bed))+
geom_point()+geom_line()+
scale_color_manual(
name="In Bed",
values = c("#009E73", "#D55E00", "#000000"),
labels=c("After Wakeup", "Asleep", "Awake"))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold", size = 14),
axis.ticks = element_blank(),
axis.line = element_blank())+
labs(title = "Average Time in Bed by Days",
y="Hours",
x="Day")
plot6
